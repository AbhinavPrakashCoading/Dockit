<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schema Extraction UI Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="gradient-bg rounded-lg p-6 mb-8 text-white">
            <h1 class="text-3xl font-bold mb-2">üìã Schema Extraction Demo</h1>
            <p class="text-lg opacity-90">Extract document requirements from exam URLs automatically</p>
        </div>

        <!-- Main Content -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Input Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-800">üîç Extract Schema</h2>
                
                <!-- URL Input -->
                <div class="mb-4">
                    <label for="urlInput" class="block text-sm font-medium text-gray-700 mb-2">
                        Exam URL
                    </label>
                    <input 
                        type="url" 
                        id="urlInput" 
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        placeholder="https://ibpsonline.ibps.in/clerk25"
                        value="https://ibpsonline.ibps.in/clerk25"
                    >
                </div>

                <!-- Quick Select Buttons -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Quick Select
                    </label>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="setUrl('https://ibpsonline.ibps.in/clerk25')" 
                                class="px-3 py-2 bg-blue-100 text-blue-800 rounded-md hover:bg-blue-200 text-sm">
                            IBPS Clerk
                        </button>
                        <button onclick="setUrl('https://sbi.co.in/careers')" 
                                class="px-3 py-2 bg-green-100 text-green-800 rounded-md hover:bg-green-200 text-sm">
                            SBI PO
                        </button>
                        <button onclick="setUrl('https://upsconline.nic.in')" 
                                class="px-3 py-2 bg-purple-100 text-purple-800 rounded-md hover:bg-purple-200 text-sm">
                            UPSC CSE
                        </button>
                        <button onclick="setUrl('https://rrb.gov.in/ntpc')" 
                                class="px-3 py-2 bg-orange-100 text-orange-800 rounded-md hover:bg-orange-200 text-sm">
                            RRB NTPC
                        </button>
                    </div>
                </div>

                <!-- Extract Button -->
                <button 
                    onclick="extractSchema()" 
                    id="extractBtn"
                    class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"
                >
                    üöÄ Extract Schema
                </button>

                <!-- Loading Indicator -->
                <div id="loading" class="hidden mt-4 text-center">
                    <div class="inline-flex items-center">
                        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        Extracting schema...
                    </div>
                </div>
            </div>

            <!-- Output Section -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-800">üìÑ Extracted Schema</h2>
                
                <div id="output" class="bg-gray-50 rounded-lg p-4 min-h-[400px] font-mono text-sm overflow-auto">
                    <div class="text-gray-500 text-center py-8">
                        Click "Extract Schema" to see results here
                    </div>
                </div>

                <!-- Download Button -->
                <button 
                    onclick="downloadSchema()" 
                    id="downloadBtn"
                    class="hidden mt-4 w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors"
                >
                    üì• Download JSON
                </button>
            </div>
        </div>

        <!-- Features Section -->
        <div class="mt-12 bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">‚ú® Features</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center">
                    <div class="text-3xl mb-2">üöÄ</div>
                    <h3 class="font-semibold text-gray-800">Fully Automated</h3>
                    <p class="text-gray-600 text-sm">Zero manual input required</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-2">üß†</div>
                    <h3 class="font-semibold text-gray-800">Intelligent Analysis</h3>
                    <p class="text-gray-600 text-sm">Detects formats, sizes, dimensions</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-2">üìä</div>
                    <h3 class="font-semibold text-gray-800">Structured Output</h3>
                    <p class="text-gray-600 text-sm">Clean JSON with confidence scores</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSchema = null;

        // Mock data for demonstration
        const mockData = {
            'https://ibpsonline.ibps.in/clerk25': {
                exam: 'IBPS Clerk 2025',
                source: 'https://ibpsonline.ibps.in/clerk25',
                extractedAt: new Date().toISOString(),
                documents: [
                    {
                        type: 'Photo',
                        requirements: {
                            format: ['JPG', 'JPEG'],
                            maxSize: '50 KB',
                            minSize: '20 KB',
                            dimensions: { width: 200, height: 230, ratio: '200:230' },
                            mandatory: true,
                            description: 'Recent passport size color photograph'
                        }
                    },
                    {
                        type: 'Signature',
                        requirements: {
                            format: ['JPG', 'JPEG'],
                            maxSize: '40 KB',
                            dimensions: { width: 140, height: 60, ratio: '140:60' },
                            mandatory: true,
                            description: 'Clear signature in black ink'
                        }
                    },
                    {
                        type: 'Thumb Impression',
                        requirements: {
                            format: ['JPG', 'JPEG'],
                            maxSize: '40 KB',
                            mandatory: true,
                            description: 'Left thumb impression'
                        }
                    },
                    {
                        type: 'Educational Documents',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '500 KB',
                            mandatory: true,
                            description: 'Educational qualification certificates'
                        }
                    }
                ],
                metadata: {
                    url: 'https://ibpsonline.ibps.in/clerk25',
                    contentType: 'text/html',
                    extractionMethod: 'html',
                    confidence: 0.95
                }
            },
            
            'https://sbi.co.in/careers': {
                exam: 'SBI PO 2025',
                source: 'https://sbi.co.in/careers',
                extractedAt: new Date().toISOString(),
                documents: [
                    {
                        type: 'Photo',
                        requirements: {
                            format: ['JPEG'],
                            maxSize: '40 KB',
                            minSize: '4 KB',
                            dimensions: { width: 200, height: 200, ratio: '1:1' },
                            mandatory: true,
                            description: 'Recent color photograph'
                        }
                    },
                    {
                        type: 'Signature',
                        requirements: {
                            format: ['JPEG'],
                            maxSize: '30 KB',
                            dimensions: { width: 140, height: 60, ratio: '140:60' },
                            mandatory: true,
                            description: 'Handwritten signature'
                        }
                    },
                    {
                        type: 'Category Certificate',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '300 KB',
                            mandatory: false,
                            description: 'SC/ST/OBC certificate (if applicable)'
                        }
                    },
                    {
                        type: 'Educational Certificates',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '1 MB',
                            mandatory: true,
                            description: 'All degree certificates'
                        }
                    }
                ],
                metadata: {
                    url: 'https://sbi.co.in/careers',
                    contentType: 'text/html',
                    extractionMethod: 'html',
                    confidence: 0.92
                }
            },

            'https://upsconline.nic.in': {
                exam: 'UPSC Civil Services Examination 2025',
                source: 'https://upsconline.nic.in',
                extractedAt: new Date().toISOString(),
                documents: [
                    {
                        type: 'Photo',
                        requirements: {
                            format: ['JPG', 'PNG'],
                            maxSize: '50 KB',
                            minSize: '3 KB',
                            dimensions: { width: 35, height: 45, ratio: 'passport size' },
                            mandatory: true,
                            description: 'Recent passport size photograph'
                        }
                    },
                    {
                        type: 'Signature',
                        requirements: {
                            format: ['JPG'],
                            maxSize: '30 KB',
                            minSize: '1 KB',
                            mandatory: true,
                            description: 'Clear signature'
                        }
                    },
                    {
                        type: 'Identity Proof',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '2 MB',
                            mandatory: true,
                            description: 'Valid identity document'
                        }
                    },
                    {
                        type: 'Address Proof',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '1 MB',
                            mandatory: true,
                            description: 'Residential address proof'
                        }
                    },
                    {
                        type: 'Educational Certificates',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '500 KB',
                            mandatory: true,
                            description: 'Educational qualification certificates'
                        }
                    }
                ],
                metadata: {
                    url: 'https://upsconline.nic.in',
                    contentType: 'text/html',
                    extractionMethod: 'html',
                    confidence: 0.88
                }
            },

            'https://rrb.gov.in/ntpc': {
                exam: 'RRB NTPC 2025',
                source: 'https://rrb.gov.in/ntpc',
                extractedAt: new Date().toISOString(),
                documents: [
                    {
                        type: 'Photo',
                        requirements: {
                            format: ['JPG'],
                            maxSize: '100 KB',
                            minSize: '20 KB',
                            dimensions: { width: 35, height: 45, ratio: '3.5cm x 4.5cm' },
                            mandatory: true,
                            description: 'Recent color passport size photograph'
                        }
                    },
                    {
                        type: 'Signature',
                        requirements: {
                            format: ['JPG'],
                            maxSize: '50 KB',
                            minSize: '10 KB',
                            mandatory: true,
                            description: 'Signature specimen in black ink'
                        }
                    },
                    {
                        type: 'Caste Certificate',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '400 KB',
                            mandatory: false,
                            description: 'For reserved categories (if applicable)'
                        }
                    },
                    {
                        type: 'Educational Qualification',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '1 MB',
                            mandatory: true,
                            description: 'Degree/diploma certificates'
                        }
                    },
                    {
                        type: 'Employment Registration',
                        requirements: {
                            format: ['PDF'],
                            maxSize: '300 KB',
                            mandatory: false,
                            description: 'Employment registration (if applicable)'
                        }
                    }
                ],
                metadata: {
                    url: 'https://rrb.gov.in/ntpc',
                    contentType: 'text/html',
                    extractionMethod: 'html',
                    confidence: 0.90
                }
            }
        };

        function setUrl(url) {
            document.getElementById('urlInput').value = url;
        }

        async function extractSchema() {
            const urlInput = document.getElementById('urlInput');
            const url = urlInput.value.trim();
            
            if (!url) {
                alert('Please enter a URL');
                return;
            }

            const loadingEl = document.getElementById('loading');
            const outputEl = document.getElementById('output');
            const extractBtn = document.getElementById('extractBtn');
            const downloadBtn = document.getElementById('downloadBtn');

            // Show loading
            loadingEl.classList.remove('hidden');
            extractBtn.disabled = true;
            extractBtn.textContent = '‚è≥ Extracting...';
            outputEl.innerHTML = '<div class="text-gray-500 text-center py-8">Processing...</div>';

            try {
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1500));

                let schema;
                if (mockData[url]) {
                    schema = mockData[url];
                } else {
                    // Generic fallback
                    schema = {
                        exam: 'Unknown Exam',
                        source: url,
                        extractedAt: new Date().toISOString(),
                        documents: [
                            {
                                type: 'Document Upload',
                                requirements: {
                                    format: ['PDF', 'JPG', 'JPEG'],
                                    maxSize: '500 KB',
                                    mandatory: true,
                                    description: 'Required documents (URL not in demo data)'
                                }
                            }
                        ],
                        metadata: {
                            url: url,
                            contentType: 'unknown',
                            extractionMethod: 'demo',
                            confidence: 0.1
                        }
                    };
                }

                currentSchema = schema;
                displaySchema(schema);
                downloadBtn.classList.remove('hidden');

            } catch (error) {
                outputEl.innerHTML = `<div class="text-red-600 text-center py-8">Error: ${error.message}</div>`;
            } finally {
                loadingEl.classList.add('hidden');
                extractBtn.disabled = false;
                extractBtn.textContent = 'üöÄ Extract Schema';
            }
        }

        function displaySchema(schema) {
            const outputEl = document.getElementById('output');
            
            // Create formatted display
            let html = `<div class="space-y-4">`;
            
            // Header
            html += `
                <div class="bg-blue-50 p-3 rounded border-l-4 border-blue-400">
                    <h3 class="font-bold text-blue-800">${schema.exam}</h3>
                    <p class="text-sm text-blue-600">Confidence: ${(schema.metadata.confidence * 100).toFixed(1)}%</p>
                </div>
            `;

            // Documents
            schema.documents.forEach((doc, index) => {
                html += `
                    <div class="border rounded-lg p-3 bg-white">
                        <h4 class="font-semibold text-gray-800 mb-2">${index + 1}. ${doc.type}</h4>
                        <div class="grid grid-cols-2 gap-2 text-sm">
                            <div><strong>Format:</strong> ${doc.requirements.format ? doc.requirements.format.join(', ') : 'Not specified'}</div>
                            <div><strong>Max Size:</strong> ${doc.requirements.maxSize || 'Not specified'}</div>
                            ${doc.requirements.minSize ? `<div><strong>Min Size:</strong> ${doc.requirements.minSize}</div>` : ''}
                            ${doc.requirements.dimensions ? `<div><strong>Dimensions:</strong> ${doc.requirements.dimensions.width || ''}x${doc.requirements.dimensions.height || ''} ${doc.requirements.dimensions.ratio || ''}</div>` : ''}
                            <div><strong>Mandatory:</strong> ${doc.requirements.mandatory ? '‚úÖ Yes' : '‚ö†Ô∏è Optional'}</div>
                        </div>
                        <p class="text-sm text-gray-600 mt-2">${doc.requirements.description}</p>
                    </div>
                `;
            });

            html += `</div>`;
            
            // Also show raw JSON
            html += `
                <details class="mt-6">
                    <summary class="cursor-pointer font-semibold text-gray-700 mb-2">üìã View Raw JSON</summary>
                    <pre class="bg-gray-800 text-green-400 p-4 rounded overflow-x-auto text-xs">${JSON.stringify(schema, null, 2)}</pre>
                </details>
            `;
            
            outputEl.innerHTML = html;
        }

        function downloadSchema() {
            if (!currentSchema) return;
            
            const dataStr = JSON.stringify(currentSchema, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `schema-${currentSchema.exam.replace(/\s+/g, '-').toLowerCase()}.json`;
            link.click();
        }

        // Initialize with first URL
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Schema Extraction UI Demo Loaded');
        });
    </script>
</body>
</html>